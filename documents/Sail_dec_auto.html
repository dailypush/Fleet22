<!DOCTYPE html>
<html>
<head>
    <title>Sail List by Tag Number</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        body {
            padding-top: 20px;
        }
        .container {
            max-width: 600px;
        }
    </style>

    <script>
        // The JSON data
        var sailsData = [
            {"Hull": "431", "Purchaser": "Pat Doyle", "Certificate No.": "0204288Q", "Sailmaker": "Quantum", "Delivery Date": "2002-06-05", "Sail Type": "J", "Fleet": "1", "Notes": ""},
            {"Hull": "431", "Purchaser": "Pat Doyle", "Certificate No.": "0204299Q", "Sailmaker": "Quantum", "Delivery Date": "2002-06-05", "Sail Type": "M", "Fleet": "1", "Notes": ""},
            {"Hull": "431", "Purchaser": "Pat Doyle", "Certificate No.": "0212659Q", "Sailmaker": "Quantum", "Delivery Date": "2002-12-30", "Sail Type": "S89", "Fleet": "1", "Notes": ""},
            // Include all other sail entries here...
            {"Hull": "431", "Purchaser": "Pat Doyle", "Certificate No.": "1505069Q", "Sailmaker": "Quantum", "Delivery Date": "2015-07-04", "Sail Type": "S89", "Fleet": "1", "Notes": ""}
        ];

        // Mapping of Hull Numbers to Boat Names (sample data)
        var boatNames = {
            "431": "Sea Breeze",
            // Add other hull numbers and boat names here
        };

        function findSailsByHull(hullNumber) {
            return sailsData.filter(function(sail) {
                return sail["Hull"] === hullNumber;
            });
        }

        function updateForm() {
            var hullNumber = document.getElementById("hullNumber").value.trim();

            if (!hullNumber) {
                alert("Please enter a hull number.");
                return;
            }

            var sails = findSailsByHull(hullNumber);

            if (sails.length === 0) {
                alert("No sails found for this hull number.");
                return;
            }

            // Assuming 'Purchaser' is the owner
            var owner = sails[0]["Purchaser"];
            document.getElementById("owner").value = owner;

            // Auto-fill boat name if available
            var boatName = boatNames[hullNumber] || "";
            document.getElementById("boatName").value = boatName;

            // Update the dropdowns
            var jibs = sails.filter(function(sail) {
                return sail["Sail Type"] === "J";
            });
            var mains = sails.filter(function(sail) {
                return sail["Sail Type"] === "M";
            });
            var spinnakers = sails.filter(function(sail) {
                return sail["Sail Type"] === "S89";
            });

            updateDropdown(document.getElementById("jib1"), jibs);
            updateDropdown(document.getElementById("jib2"), jibs);
            updateDropdown(document.getElementById("main"), mains);
            updateDropdown(document.getElementById("spinnaker"), spinnakers);
        }

        function updateDropdown(selectElement, sails) {
            // Clear existing options
            selectElement.innerHTML = '<option value="">Select</option>';

            sails.forEach(function(sail) {
                var option = document.createElement('option');
                option.value = sail["Certificate No."];
                option.text = sail["Certificate No."] + " (" + sail["Delivery Date"] + ", " + sail["Sailmaker"] + ")";
                selectElement.appendChild(option);
            });
        }

        function getSailByCertificate(certNo) {
            return sailsData.find(function(sail) {
                return sail["Certificate No."] === certNo;
            });
        }

        function printSails() {
            var hullNumber = document.getElementById("hullNumber").value;
            var owner = document.getElementById("owner").value;
            var boatName = document.getElementById("boatName").value;
            var email = document.getElementById("email").value;
            var mobile = document.getElementById("mobile").value;

            var jib1Cert = document.getElementById("jib1").value;
            var jib2Cert = document.getElementById("jib2").value;
            var mainCert = document.getElementById("main").value;
            var spinnakerCert = document.getElementById("spinnaker").value;

            // Retrieve sail details including sailmaker
            var jib1Sail = getSailByCertificate(jib1Cert);
            var jib2Sail = getSailByCertificate(jib2Cert);
            var mainSail = getSailByCertificate(mainCert);
            var spinnakerSail = getSailByCertificate(spinnakerCert);

            var printContent = `
                <h2>Sail List for Hull ${hullNumber}</h2>
                <p><strong>Boat Name:</strong> ${boatName || 'Not Provided'}</p>
                <p><strong>Owner:</strong> ${owner}</p>
                <p><strong>Email:</strong> ${email || 'Not Provided'}</p>
                <p><strong>Mobile:</strong> ${mobile || 'Not Provided'}</p>
                <ul>
                    <li><strong>Jib 1:</strong> ${formatSailInfo(jib1Sail)}</li>
                    <li><strong>Jib 2:</strong> ${formatSailInfo(jib2Sail)}</li>
                    <li><strong>Main:</strong> ${formatSailInfo(mainSail)}</li>
                    <li><strong>Spinnaker:</strong> ${formatSailInfo(spinnakerSail)}</li>
                </ul>
            `;

            var printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Sail List</title>');
            printWindow.document.write('<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">');
            printWindow.document.write('</head><body>');
            printWindow.document.write('<div class="container mt-5">');
            printWindow.document.write(printContent);
            printWindow.document.write('</div>');
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        function formatSailInfo(sail) {
            if (!sail) {
                return 'Not Selected';
            }
            return sail["Certificate No."] + " (" + sail["Delivery Date"] + ", " + sail["Sailmaker"] + ")";
        }
    </script>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Sail List by Tag Number</h1>
        <form>
            <div class="form-group">
                <label for="hullNumber">Enter Hull Number:</label>
                <input type="text" class="form-control" id="hullNumber" name="hullNumber" placeholder="Enter hull number">
            </div>
            <button type="button" class="btn btn-primary mb-3" onclick="updateForm()">Submit</button>

            <div class="form-group">
                <label for="owner">Owner:</label>
                <input type="text" class="form-control" id="owner" name="owner">
            </div>

            <div class="form-group">
                <label for="boatName">Boat Name:</label>
                <input type="text" class="form-control" id="boatName" name="boatName">
            </div>

            <div class="form-group">
                <label for="email">Email Address:</label>
                <input type="email" class="form-control" id="email" name="email" placeholder="Enter email address">
            </div>

            <div class="form-group">
                <label for="mobile">Mobile Number:</label>
                <input type="tel" class="form-control" id="mobile" name="mobile" placeholder="Enter mobile number">
            </div>

            <h3>Select Sails</h3>

            <div class="form-group">
                <label for="jib1">Jib 1:</label>
                <select class="form-control" id="jib1" name="jib1">
                    <option value="">Select</option>
                </select>
            </div>

            <div class="form-group">
                <label for="jib2">Jib 2:</label>
                <select class="form-control" id="jib2" name="jib2">
                    <option value="">Select</option>
                </select>
            </div>

            <div class="form-group">
                <label for="main">Main:</label>
                <select class="form-control" id="main" name="main">
                    <option value="">Select</option>
                </select>
            </div>

            <div class="form-group">
                <label for="spinnaker">Spinnaker:</label>
                <select class="form-control" id="spinnaker" name="spinnaker">
                    <option value="">Select</option>
                </select>
            </div>

            <button type="button" class="btn btn-success" onclick="printSails()">Print</button>
        </form>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
